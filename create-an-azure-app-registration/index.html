<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>EUC365 | Create an Azure App Registration</title>

  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="description" content="Create an Azure Active Directory App Registration step by step">
  <meta name="author" content="David Brook">
  <meta name="generator" content="Hugo 0.75.1" />

  
  <link rel="preload" href="https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFWJ0bbck.woff2" style="font-display: optional;">
  
  
  
  <link rel="stylesheet" href="https://hugo.euc365.com/plugins/bootstrap/bootstrap.min.css" >
  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:600%7cOpen&#43;Sans&amp;display=swap" >
  
  
  
  <link rel="stylesheet" href="https://hugo.euc365.com/plugins/themify-icons/themify-icons.css" >
  
  
  
  <link rel="stylesheet" href="https://hugo.euc365.com/plugins/slick/slick.css" >
  
  
  
  <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.25/default/snipcart.css" >
  
  

  
  
  <link rel="stylesheet" href="https://hugo.euc365.com/scss/style.css" media="screen">

  
  <link rel="shortcut icon" href="https://hugo.euc365.com/images/favicon.png" type="image/x-icon">
  <link rel="icon" href="https://hugo.euc365.com/images/favicon.png" type="image/x-icon">

  <meta property="og:title" content="Create an Azure App Registration" />
<meta property="og:description" content="Create an Azure Active Directory App Registration step by step" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hugo.euc365.com/create-an-azure-app-registration/" />
<meta property="og:image" content="https://hugo.euc365.com/images/post/createazureapp/featuredImage.png" />
<meta property="article:published_time" content="2020-07-08T10:00:00+00:00" />
<meta property="article:modified_time" content="2020-07-08T10:00:00+00:00" />

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-176926283-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-176926283-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</head><body><!-- navigation -->
<header class="sticky-top bg-white border-bottom border-default">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white">
      <a class="navbar-brand" href="/">
        <img class="img-fluid" width="150px" src="https://hugo.euc365.com/images/logo.png" alt="Homepage"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <ul class="navbar-nav ml-auto">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://hugo.euc365.com/">homepage</a>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              Posts <i class="ti-angle-down ml-1"></i>
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="https://hugo.euc365.com/categories/autopilot">Autopilot</a>
              
              <a class="dropdown-item" href="https://hugo.euc365.com/categories/azure">Azure</a>
              
              <a class="dropdown-item" href="https://hugo.euc365.com/categories/intune">Intune</a>
              
              <a class="dropdown-item" href="https://hugo.euc365.com/categories/microsoft-graph-api">Microsoft Graph API</a>
              
              <a class="dropdown-item" href="https://hugo.euc365.com/categories/powershell">PowerShell</a>
              
            </div>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://hugo.euc365.com/about">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://hugo.euc365.com/contact">Contact</a>
          </li>
          
          
        </ul>

        
        

        
        <!-- search -->
        <div class="search px-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="/search" class="h-100">
              <input class="search-box pl-4" id="search-query" name="s" type="search" placeholder="Type &amp; Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->




<section class="section">
  <div class="container">
    <article class="row mb-4">
      <div class="col-lg-10 mx-auto mb-4">
        <h1 class="h2 mb-3">Create an Azure App Registration</h1>
        <ul class="list-inline post-meta mb-3">
          <li class="list-inline-item"><i class="ti-user mr-2"></i><a
              href="/author/david-brook/">David Brook</a></li>
          <li class="list-inline-item">Date : 8 July, 2020</li>
          <li class="list-inline-item">Categories :
            <a
              href="/categories/azure" class="ml-1">Azure </a>
            ,<a
              href="/categories/azure-ad" class="ml-1">Azure a d </a>
            ,<a
              href="/categories/azure-app-registrtions" class="ml-1">Azure app registrtions </a>
            </li>
          <li class="list-inline-item">Tags : 
          </li>
        </ul>
      </div>
      
      
      
      <div class="col-lg-10 mx-auto">
        <div class="content"><h3 id="what-can-you-use-an-azure-app-registration-for">What can you use an Azure App Registration for</h3>
<p>An Azure App Registration has many uses, in my case I use it mainly for the Microsoft Graph API to perform Intune Configuration Profile backups, List devices, Update local CMDB dynamically and also enrol devices into Autopilot.</p>
<p>You will see the vast amount of options you can use for the API when you start adding the API permissions below.</p>
<p>If you are also using MEMCM and Co-Managing devices with Intune or you have this Azure Tenant attached this will also be using an Azure App Registration to read user details and use user impersonation.</p>
<p>However as you will notice this guide is focused on using the App Registration with the Microsoft Graph API with Client Secrets.</p>
<h3 id="finding-what-api-permission-is-required-for-your-microsoft-graph-api-call">Finding what API Permission is required for your Microsoft Graph API Call</h3>
<p>Each API can have a different set of permissions required to be able to read and/or write data. The best way to find these is by using the <a href="https://docs.microsoft.com/en-us/graph/api/overview?view=graph-rest-1." target="_blank">
    Microsoft Graph API Reference Guide
  </a>.</p>
<p>Once you have loaded the API Reference guide, you will notice a list of categories for the API like below.</p>
<p><img class="aligncenter" src="/images/post/getdeviceinfo/API_Ref_v1.png" alt="" width="250" height="300" /></p>
<p>For this post I am using the <strong>importedWindowsAutopilotDeviceIdentities</strong> API reference which is in the Beta API. You can change what API Reference you are using by using the drop down under the <strong>Version</strong> header in the left-hand pane.</p>
<p>If you browse to <strong>Devices and apps &gt; Corporate management &gt; Imported windows autopilot device identity &gt; List</strong>, You will see under the prerequisites which permissions that particular API requires as highlighted below.</p>


<div class="notices note" ><p>I will be using the <strong>Application</strong> permissions as the App this was created for is unattended</p></div>

<p><img class="aligncenter" src="/images/post/createazureapp/List_PreReq-1.png" alt="" width="620" height="382" /></p>
<p>You will notice that even though you are only listing devices that the ReadWrite permission is listed in the permission set. If you look closer at the permission table headers you will see it states <strong>Permissions (from most to least privileged)</strong> meaning that to use the full functionality of this API (such as Create, Delete and Update) you will need the ReadWrite permission, However if you just wanted to list the data you would only need the least amount of privileges which is Read.</p>
<p>Have a browse around and notice the differences in different categories before moving on.</p>
<h3 id="creating-the-azure-app-registration">Creating the Azure App Registration</h3>
<p>Head over to the <a href="https://portal.azure.com" target="_blank">
    Azure Portal
  </a> and launch Azure Active Directory.</p>
<p>From the pane on the left select <a href="https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps" target="_blank">
    &lt;strong&gt;App Registrations&lt;/strong&gt;
  </a>, from here you can either choose to use an existing registrations or create one for this specific purpose. I would however recommend that you use a specific one for this purpose, this way the app does not have more permissions than it requires.</p>
<p>Lets get started;</p>
<ul>
 	<li>Click <b>New Registration</b> from the ribbon</li>
 	<li>Give the App a name that represents its purpose and leave the rest as default and click Register</li>
</ul>
<p><img class="aligncenter" src="/images/post/createazureapp/RegisterAppPage.png" alt="" width="833" height="655" /></p>
<ul>
 	<li>From the left pane, select <b>API Permissions</b>, This is where we are going to grant the App the permission to the Microsoft Graph <b>API</b></li>
 	<li>Select <b>Add a permission</b> from the ribbon, you will see a pop out like the below;</li>
</ul>
<p><img class="aligncenter" src="/images/post/createazureapp/RequestAPIPerm.png" alt="" width="806" height="461" /></p>
<ul>
 	<li>Click on <b>Microsoft Graph &gt; Application Permissions</b></li>
 	<li>In the search box type <b>Service</b> and this will show the permissions we require</li>
</ul>
<p><img class="aligncenter" src="/images/post/createazureapp/ServiceConfig-1.png" alt="" width="836" height="433" /></p>
<ul>
 	<li>Click <b>Add Permissions</b></li>
 	<li>You will then see a orange banner stating that the permissions are being edited and consent will need to be given</li>
</ul>
<p><img class="aligncenter" src="/images/post/createazureapp/PermissionBanner.png" alt="" width="805" height="84" class="aligncenter" /></p>
<ul>
 	<li>Click the <b>Grant admin consent for</b>, click <b>Yes</b> on the banner to confirm your would like to grant consent</li>
</ul>
<p><img class="aligncenter" src="/images/post/createazureapp/GrantPerm-1024x202.png" alt="" width="1024" height="202" /></h2></p>
<ul>
 	<li>Next we need a client secret... you will need to store this in a safe place as once you click of the page its hides all but a few characters. Click <b>Client &amp; Secrets</b> from the pane on the left</li>
 	<li>Click <b>New Client Secret</b>
		<ul>
			<li>Specify a description, if you are going to put this in numerous locations and let multiple people use it you could relate it to that team/department. But for this example we will keep it simple.</li>
			<li>Specify a validity period, you have three options, 1 year, 2 years or never. I would not recommend using the later and would ensure that you have processes in place to review the application</li>
		</ul>
	</li>
</ul>
<p><img class="aligncenter" src="/images/post/createazureapp/ClientSecret.png" alt="" width="354" height="274" /></p>
<ul>
 	<li>When you have added the secret, copy the value as you will need this later.</li>
</ul>
<p>To go with the client secret you will also need the Application (Client) ID and the Directory (tenant) ID. These can be found on the <strong>Overview</strong> page.</p>
<p><img class="aligncenter" src="/images/post/createazureapp/CLientID_AppReg.png" alt="" width="821" height="270" /></p>
<p>The details you have gathered from this article you can use them to perform unattended actions on the Microsoft Graph API and other services. I will be posting some other blog posts which relate to using these details so keep an eye on the blog for interesting ways to use the App Registrations.</p>
</div>
      </div>
    </article>
    
    
    <div class="row">
      <div class="col-lg-10 mx-auto">
        <div class="mt-5">
          <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "euc365-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
      </div>
    </div>
    
  </div>
</section>




<footer class="section-sm pb-0 border-top border-default">
  <div class="container">
    <div class="row justify-content-between">
      <div class="col-md-3 mb-4">
        <a class="mb-4 d-block" href="/"><img class="img-fluid" width="150px" src="https://hugo.euc365.com/images/logo.png" alt="Homepage"></a>
        <p>Thank you for looking at my Tech, Tips and other bits.</p>
      </div>
      <div class="col-lg-2 col-md-3 col-6 mb-4">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled footer-list">
          
          
          <li><a href="https://hugo.euc365.com/about">About</a></li>
          
          
          <li><a href="https://hugo.euc365.com/contact">Contact</a></li>
          
        </ul>
      </div>
      <div class="col-lg-2 col-md-3 col-6 mb-4">
        <h6 class="mb-4">Social Links</h6>
        <ul class="list-unstyled footer-list">
          
          <li><a href="https://www.twitter.com/dbbrook24">Twitter</a></li>
          
          <li><a href="https://www.linkedin.com/in/david-brook-81796145/">linkedin</a></li>
          
          <li><a href="https://github.com/brookd2404">github</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-3 mb-4">
        <h6 class="mb-4">Subscribe Newsletter</h6>
        
        <form class="subscription" action="https://euc365.us1.list-manage.com/subscribe/post?u=5be29b0e8342fd1942dd179e6&amp;amp;id=4afea5f508" method="post" name="mc-embedded-subscribe-form"
          target="_blank">
          <div class="position-relative">
            <i class="ti-email email-icon"></i>
            <input type="email" class="form-control" placeholder="Your Email Address">
          </div>
          <button class="btn btn-primary btn-block rounded" type="submit"
            name="subscribe">Subscribe now</button>
          <div style="position: absolute; left: -5000px;" aria-hidden="true">
            <input type="text" name="b_5be29b0e8342fd1942dd179e6_4afea5f508" tabindex="-1">
          </div>
        </form>
        
      </div>
      
    </div>
    <div class="scroll-top">
      <a href="javascript:void(0);" id="scrollTop"><i class="ti-angle-up"></i></a>
    </div>
    <div class="text-center">
      <p class="content">Design By <a href="https://euc365.com/">EUC365</a> Hosted By <a href="https://github.com/">GitHub</a></p>
    </div>
  </div>
</footer>








<script src="https://hugo.euc365.com/plugins/jQuery/jquery.min.js" ></script>



<script src="https://hugo.euc365.com/plugins/bootstrap/bootstrap.min.js" async></script>



<script src="https://hugo.euc365.com/plugins/slick/slick.min.js" ></script>









<script src="https://hugo.euc365.com/plugins/turbolinks/turbolinks.js" ></script>



<script src="https://cdn.snipcart.com/themes/v3.0.25/default/snipcart.js" async></script>





<script src="https://hugo.euc365.com/js/script.min.js"></script></body>

</html>